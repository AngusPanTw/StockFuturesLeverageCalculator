# 股票及期貨庫存槓桿比例計算機 (Stock & Futures Leverage Calculator)

這是一個基於 WPF (.NET 8.0) 開發的桌面應用程式，專為同時持有股票與期貨部位的投資人設計。它可以協助您即時計算投資組合的總曝險、總淨資產以及槓桿倍數，並提供風險狀態警示。

## ✨ 功能特色

*   **資產整合管理**：
    *   整合銀行存款、股票交割款、期貨權益金。
    *   自動計算總淨資產。
*   **股票庫存管理**：
    *   記錄股票名稱、股數、總成本、總市值。
    *   **即時損益計算**：自動顯示未實現損益金額與報酬率 (%)。
    *   紅綠變色顯示：獲利顯示紅色，虧損顯示綠色 (台股慣例)。
*   **期貨庫存管理**：
    *   支援 **大台 (2000股)** 與 **小台 (100股)** 合約。
    *   支援 **多單 (Long)** 與 **空單 (Short)** 部位。
    *   自動計算 **曝險市值** (合約價值)。
    *   即時損益與報酬率計算。
*   **風險監控儀表板**：
    *   **總曝險部位**：股票市值 + 期貨總曝險。
    *   **槓桿倍數**：總曝險 / 總淨資產。
    *   **風險狀態警示**：
        *   穩定 (槓桿 <= 1.0)
        *   適中 (1.0 < 槓桿 <= 2.0)
        *   高風險 (槓桿 > 2.0)
*   **使用者體驗優化**：
    *   自動儲存投資組合資料 (`portfolio.json`)，下次開啟自動載入。
    *   數值自動格式化 (千分位)。
    *   欄位寬度自動調整。
    *   精美且易讀的 UI 設計。

## 🛠️ 技術堆疊

*   **框架**: .NET 8.0 (WPF)
*   **架構**: MVVM (Model-View-ViewModel)
*   **語言**: C#
*   **資料儲存**: JSON (System.Text.Json)

## 🚀 如何執行

1.  確保您的電腦已安裝 [.NET 8.0 SDK](https://dotnet.microsoft.com/download/dotnet/8.0)。
2.  使用 Visual Studio 2022 或 VS Code 開啟專案資料夾。
3.  建置並執行 `LeverageCalculator` 專案。

## 📝 使用說明

1.  **輸入資金**：在左上角輸入您的銀行現金、交割款與期貨權益金。
2.  **新增股票**：輸入股票名稱、股數、總成本與市值，點擊新增。
3.  **新增期貨**：輸入代號、口數、方向、成本與市價，選擇合約類型 (大/小股票期貨)，點擊新增。
4.  **查看報告**：右側面板會即時更新您的資產分佈、槓桿倍數與風險狀態。
5.  **刪除項目**：點擊列表右側的「刪除」按鈕即可移除項目。
